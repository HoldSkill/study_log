# 综合问题

### 1.接口幂等性

一次或者多次请求造成的影响一致

**前端限制**：
1.页面重定向，当点击支付或者提交等按钮时，页面重定向到其他的页面，比如等等页面，或者成功页面
2.在进入具体操作页面的时候，生成一个唯一标识，存在session中并且传到前端，支付或者提交时，前端把唯一标识传给后端，后端判断唯一标识是否存在，如果存在，表示第一次操作，执行具体业务逻辑，然后删除唯一标识(有问题，如果先删标识，如果后面逻辑执行失败怎么办，或者是后删标识也有同样的问题)

**后端限制（要结合多种方案来解决幂等性）：**
1.使用唯一索引(业务字段组合来的联合唯一索引)来限制，简单粗暴
2.token+redis来验证，在进入具体操作页面的时候，生成一个token，存在redis中并且传到前端，支付或者提交时，前端把token给后端，后端判断redis中token是否存在，如果存在，表示第一次操作，（如果在高并发情况下，可以给token加一个状态，在判断时，判断token的状态），执行具体业务逻辑，然后删除token
3.状态机幂等：比如，订单的状态是单项的不可逆的，where条件中加上期望的状态，
4.通过乐观锁来实现幂等
5.防重表(其实就是加锁的功能)，如以订单id作为防重表的唯一索引，在执行订单执行等操作的时候，插入这张表,具体操作执行完成后，删除这条数据
6.分布式锁
7.缓冲队列：把请求放在队列中，使用异步任务来处理，可以在队列中来处理重复，缺点是不能及时获取请求结果
8.提供外部接口：需要附带source来源+seq序列号来生成一个唯一索引，执行具体逻辑前判断该条记录是否处理过



### 2.微服务

##### 2.1  什么是微服务

就是将单个应用拆分成数个或者数十个支持服务，旨在通过将功能分解到各个离散的服务来对解决方案的解耦

##### 2.2 微服务的特点

独立开发，独立部署，故障隔离，混合技术栈，每个服务注重单一功能，解耦

##### 2.3 微服务有哪些缺点

- 增加了故障排查难度
- 远程调用延迟增加
- 增加了配置和其他操作的工作量

##### 2.4 SOA和微服务之间的主要区别是什么

- soa遵循尽可能多的共享，微服务遵循尽可能少的共享
- soa侧重业务功能的重用，微服务侧重于界限上下文的概念
- soa使用企业服务总线（ESB）进行通信，微服务使用简单的消息系统
- soa最大化服务的可重用性，微服务专注于解耦